#!/bin/sh

case $1 in
connected)
  case $2 in
  get)
    connected=`cat /Oya/internet_status/connected`
    echo ${connected}
    ;;
  set)
    connected=$3
    echo ${connected} > /Oya/internet_status/connected
    ;;
  esac
  ;;
pid)
  case $2 in
  get)
    pid=`cat /Oya/pid/internet_status`
    echo ${pid}
    ;;
  set)
    pid=$3
    echo ${pid} > /Oya/pid/internet_status
    ;;
  remove)
    rm /Oya/pid/internet_status
  esac
  ;;
commit)

  curState=`internet_status connected get`
  if [ ${curState} == "1" ]; then
    wifi_mode ap
  elif [ ${curState} == "0" ]; then
    wifi_mode apsta
  fi

  /etc/init.d/uploading restart
  /etc/init.d/islinked restart
  /etc/init.d/mqtt restart
  sh /Oya/led.sh
  ;;
esac
